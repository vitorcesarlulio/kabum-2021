$(document).ready(function(){var a=$("#listPeople").DataTable({deferRender:!0,processing:!0,serverSide:!0,ajax:{url:"/pessoas/listar",type:"POST",data:function(a){var b=$("#formFiltersPeople #startDate").val(),c=$("#formFiltersPeople #endDate").val();a.startDate=b,a.endDate=c}},language:{url:"//cdn.datatables.net/plug-ins/1.10.21/i18n/Portuguese-Brasil.json"},autoWidth:!1,columnDefs:[{targets:6,width:"10%",orderable:!1,searchable:!1},{targets:5,width:"12%"}],responsive:!0,lengthChange:!0,keys:!0,fixedHeader:!0,colReorder:!0,dom:"B <\"clear\"> lfrtip",lengthMenu:[[10,25,50,100,-1],["10","25","50","100","Tudo"]],buttons:[{extend:"collection",text:"Controle",autoClose:!0,buttons:[{extend:"pageLength",text:"Resultados por p\xE1gina"},{extend:"pdfHtml5",key:{key:"p",altKey:!0},text:"<u>P</u>DF &nbsp; <i class=\"far fa-file-pdf\"></i>",orientation:"landscape",pageSize:"A4",download:"open",header:!0,exportOptions:{columns:[0,1,2,3,4,5],order:"applied"},customize:function(a){a.content[1].table.widths=["25%","10%","10%","25%","20%","10%"],a.pageMargins=[20,65,20,35],a.defaultStyle.fontSize=10,a.styles.tableHeader.fontSize=12,a.styles.tableHeader.fillColor="#0060B1",a.content.splice(0,1),a.defaultStyle.alignment="center";var b=document.getElementById("descriptionReport"),c=b.value;a.header=function(){return{columns:[{image:logoPDF,width:130},{alignment:"right",fontSize:13,text:c}],margin:20}};var d=new Date,e=d.getDate()+"/"+(d.getMonth()+1)+"/"+d.getFullYear();a.footer=function(a,b){return{columns:[{alignment:"left",text:["Criado em: ",{text:e.toString()}]},{alignment:"center",text:"Ouse - Intelig\xEAncia em Marcas"},{alignment:"right",text:["P\xE1gina: ",{text:a.toString()}," de: ",{text:b.toString()}]}],margin:[20,10,20,10]}}}},{extend:"excel",text:"<u>E</u>xcel &nbsp; <i class=\"far fa-file-excel\"></i>",key:{key:"e",altKey:!0},exportOptions:{columns:[0,1,2,3,4]}},{collectionTitle:"Visibilidade da coluna",text:"Visibilidade da coluna",extend:"colvis",collectionLayout:"two-column"}]}]});$("#formFiltersPeople #startDate").change(function(){a.draw()}),$("#formFiltersPeople #endDate").change(function(){a.draw()})});function selTypePerson(){var a=document.getElementById("optionPhysicalPerson").checked;a?($("#physicalLegal").hide(),$("#divCompanyName").hide(),$("#divFantasyName").hide(),$("#divNumber").hide(),$("#divPhysicalPerson").show(),$("#divName").show(),$("#divSurname").show(),$("#divTypeResidence").show(),$("#cnpj").val("")):($("#divPhysicalPerson").hide(),$("#divName").hide(),$("#divSurname").hide(),$("#divTypeResidence").hide(),$("#physicalLegal").show(),$("#divCompanyName").show(),$("#divFantasyName").show(),$("#divNumber").show(),$("#cpf").val(""))}function findCPF(){var a=$("#cpf").serialize();$.ajax({type:"POST",url:"/pessoas/verificar-existencia-pessoa",data:a,processData:!1,success:function(a){"foundCpf"===a?(toastr.warning("Erro: CPF j\xE1 existente no banco de dados!"),$("#btnRegisterPeople").hide()):$("#btnRegisterPeople").show()},error:function(){toastr.error("Erro: n\xE3o foi poss\xEDvel verificar a pessoa, contate o administrador do sistema!")}})}$("#cnpj").blur(function(){var a=$("#cnpj").serialize();$.ajax({type:"POST",url:"/pessoas/verificar-existencia-pessoa",data:a,processData:!1,success:function(a){"foundCnpj"===a?(toastr.warning("Erro: CNPJ j\xE1 existente no banco de dados!"),$("#btnRegisterPeople").hide()):$("#btnRegisterPeople").show()},error:function(){toastr.error("Erro: n\xE3o foi poss\xEDvel verificar a pessoa, contate o administrador do sistema!")}})}),$(document).ready(function(){$("#companyName").keyup(function(){$(this).val($(this).val().toUpperCase())}),$("#fantasyName").keyup(function(){$(this).val($(this).val().toUpperCase())})});function ckeckCnpj(a){$.ajax({url:"https://www.receitaws.com.br/v1/cnpj/"+a.replace(/[^0-9]/g,""),type:"GET",dataType:"jsonp",success:function(a){$("#formRegisterPeople #companyName").val(a.nome),$("#formRegisterPeople #fantasyName").val(a.fantasia)}})}function optionTypeResidence(){var a=document.getElementById("optionHome").checked,b=document.getElementById("optionCondominium").checked;$("#edifice").val(""),$("#block").val(""),$("#apartment").val(""),$("#streetCondominium").val(""),$("#number").val(""),a?($("#divEdifice").hide(),$("#divBlock").hide(),$("#divApartment").hide(),$("#divStreetCondominium").hide(),$("#divNumber").show()):b?($("#divEdifice").hide(),$("#divBlock").hide(),$("#divApartment").hide(),$("#divStreetCondominium").show(),$("#divNumber").show()):($("#divEdifice").show(),$("#divBlock").show(),$("#divApartment").show(),$("#divStreetCondominium").hide(),$("#divNumber").hide())}$(document).on("click",".btn-edit-people",function(){var a=$(this).attr("id");$(".tr-contacts").remove(),$.ajax({url:"/pessoas/listar-contatos",type:"POST",data:{idPeople:a},dataType:"json",success:function(b){if(b){for(people of b)$("#tBodyTableContact").append(`<tr id="trContacts" class="tr-contacts">
                            <td>`+people.cont_tipo+`</td>
                            <td>`+people.cont_responsavel+`</td>
                            <td>`+people.cont_contato+`</td>
                            <td>
                                <div class="btn-group btn-group-sm">
                                    <button type="button" name="deleteContact" class="btn btn-danger btn-delete-contact" id="`+people.cont_codigo+`"><i class="fas fa-trash"></i></button>
                                </div>
                            </td>
                        </tr>`);$(".btn-save-contact").attr("id",a)}}}),$.ajax({url:"/pessoas/listar-editar",type:"POST",data:{idPeopleEdit:a},success:function(a){if(JSON.parse(a).length){var b=JSON.parse(a)[0];$("#modalEditPeople #idPeopleEdit").val(b.pess_codigo),"C"===b.pess_classificacao?$("#modalEditPeople #classificationPersonCEdit").prop("checked",!0):$("#modalEditPeople #classificationPersonFEdit").prop("checked",!0),"F"===b.pess_tipo?($("#modalEditPeople #divPhysicalPersonEdit").show(),$("#modalEditPeople #divNameEdit").show(),$("#modalEditPeople #divSurnameEdit").show(),$("#modalEditPeople #divTypeResidenceEdit").show(),$("#modalEditPeople #cpfEdit").val(b.pess_cpfcnpj),$("#modalEditPeople #nameEdit").val(b.pess_nome),$("#modalEditPeople #surnameEdit").val(b.pess_sobrenome),$("#modalEditPeople #cepEdit").val(b.pess_cep),$("#modalEditPeople #logradouroEdit").val(b.pess_logradouro),$("#modalEditPeople #bairroEdit").val(b.pess_bairro),$("#modalEditPeople #localidadeEdit").val(b.pess_cidade),$("#modalEditPeople #ufEdit").val(b.pess_estado),$("#modalEditPeople #physicalLegalEdit").hide(),$("#modalEditPeople #divCompanyNameEdit").hide(),$("#modalEditPeople #divFantasyNameEdit").hide(),$("#modalEditPeople #divNumberEdit").hide(),""===b.pess_edificio?""===b.pess_logradouro_condominio?""!==b.pess_log_numero&&""==b.pess_logradouro_condominio&&($("#modalEditPeople #optionHomeEdit").prop("checked",!0),$("#modalEditPeople #divNumberEdit").show(),$("#modalEditPeople #numberEdit").val(b.pess_log_numero),$("#modalEditPeople #divEdificeEdit").hide(),$("#modalEditPeople #divBlockEdit").hide(),$("#modalEditPeople #divApartmentEdit").hide(),$("#modalEditPeople #divStreetCondominiumEdit").hide()):($("#modalEditPeople #optionCondominiumEdit").prop("checked",!0),$("#modalEditPeople #divStreetCondominiumEdit").show(),$("#modalEditPeople #divNumberEdit").show(),$("#modalEditPeople #modalEditPeople #numberEdit").val(b.pess_log_numero),$("#modalEditPeople #divEdificeEdit").hide(),$("#modalEditPeople #divBlockEdit").hide(),$("#modalEditPeople #divApartmentEdit").hide()):($("#modalEditPeople #optionBuildingEdit").prop("checked",!0),$("#modalEditPeople #divEdificeEdit").show(),$("#modalEditPeople #divBlockEdit").show(),$("#modalEditPeople #divApartmentEdit").show(),$("#modalEditPeople #divStreetCondominiumEdit").hide(),$("#modalEditPeople #divNumberEdit").hide())):($("#modalEditPeople #physicalLegalEdit").show(),$("#modalEditPeople #divCompanyNameEdit").show(),$("#modalEditPeople #divFantasyNameEdit").show(),$("#modalEditPeople #divNumberEdit").show(),$("#modalEditPeople #cnpjEdit").val(b.pess_cpfcnpj),$("#modalEditPeople #companyNameEdit").val(b.pess_razao_social),$("#modalEditPeople #fantasyNameEdit").val(b.pess_nome_fantasia),$("#modalEditPeople #cepEdit").val(b.pess_cep),$("#modalEditPeople #logradouroEdit").val(b.pess_logradouro),$("#modalEditPeople #bairroEdit").val(b.pess_bairro),$("#modalEditPeople #localidadeEdit").val(b.pess_cidade),$("#modalEditPeople #ufEdit").val(b.pess_estado),$("#modalEditPeople #numberEdit").val(b.pess_log_numero),$("#modalEditPeople #divPhysicalPersonEdit").hide(),$("#modalEditPeople #divNameEdit").hide(),$("#modalEditPeople #divSurnameEdit").hide(),$("#modalEditPeople #divTypeResidenceEdit").hide()),$("#modalEditPeople #dateInsertEdit").val(b.pess_data_cadastro),$("#modalEditPeople #observationEdit").val(b.pess_observacao),$("#modalEditPeople").modal("show")}}})}),$(document).on("click",".btn-save-contact",function(){var a=$("#tBodyTableContact #selectTypeContact").val(),b=$("#tBodyTableContact #responsibleContact").val();if(""!==$("#tBodyTableContact #cellphoneContact").val()&&null!==$("#tBodyTableContact #cellphoneContact").val())var c=$("#tBodyTableContact #cellphoneContact").val();else if(""!==$("#tBodyTableContact #telephoneContact").val()&&null!==$("#tBodyTableContact #telephoneContact").val())var c=$("#tBodyTableContact #telephoneContact").val();else var c=$("#tBodyTableContact #emailContact").val();var d=$(this).attr("id");$.ajax({url:"/pessoas/cadastrar-contato",type:"POST",data:{typeContact:a,responsibleContact:b,contact:c,idPeopleContact:d},success:function(d){!0===d?(toastr.success("Sucesso: contato cadastrado!"),$("#tBodyTableContact").append(`<tr id="trContacts">
                    <td>`+a+`</td>
                    <td>`+b+`</td>
                    <td>`+c+`</td>
                    <td> 
                        <div class="btn-group btn-group-sm">
                            <a href="/pessoas"><button type="button" name="saveContact" class="btn btn-primary"><i class="fas fa-sync-alt"></i></button></a>
                        </div>
                    </td>
                </tr>`),$("#tBodyTableContact #responsibleContact").val(""),$("#tBodyTableContact #cellphoneContact").val(""),$("#tBodyTableContact #telephoneContact").val(""),$("#tBodyTableContact #emailContact").val("")):!1===d?toastr.error("Erro: contato n\xE3o cadastrado!"):toastr.warning("Preencha todos os campos!")},error:function(){toastr.error("Erro: dados n\xE3o enviados ao servidor, contate o administrador do sistema!")}})}),window.onload=function(){document.getElementById("selectTypeContact").addEventListener("change",function(){"Celular"==this.value?($("#tBodyTableContact #tdTelephone").hide(),$("#tBodyTableContact #tdEmail").hide(),$("#tBodyTableContact #tdCellphone").show()):"Telefone"==this.value?($("#tBodyTableContact #tdCellphone").hide(),$("#tBodyTableContact #tdEmail").hide(),$("#tBodyTableContact #tdTelephone").show()):($("#tBodyTableContact #tdCellphone").hide(),$("#tBodyTableContact #tdTelephone").hide(),$("#tBodyTableContact #tdEmail").show())})},$(document).on("click",".btn-delete-contact",function(){var a=$(this).attr("id");$.confirm({title:"Aten\xE7\xE3o!",content:"Realmente deseja excluir esse contato?",type:"red",buttons:{omg:{text:"Sim",btnClass:"btn-red",action:function(){$.ajax({url:"/pessoas/deletar-contato",type:"POST",data:{idContact:a},success:function(b){!0===b?(toastr.success("Sucesso: contato apagado!"),$("#"+a).remove()):toastr.error("Erro: contato n\xE3o apagado!")},error:function(){toastr.error("Erro: dados n\xE3o enviados ao servidor, contate o administrador do sistema!")}})}},close:{text:"N\xE3o"}}})});function callbackCep(a){"erro"in a?alert("CEP n\xE3o encontrado."):($("#modalEditPeople #logradouroEdit").val(a.logradouro),$("#modalEditPeople #bairroEdit").val(a.bairro),$("#modalEditPeople #localidadeEdit").val(a.localidade),$("#modalEditPeople #ufEdit").val(a.uf))}function pesquisaCep(a){var b=a.replace(/\D/g,"");if(""!=b){if(/^[0-9]{8}$/.test(b)){var c=document.createElement("script");c.src="//viacep.com.br/ws/"+b+"/json/?callback=callbackCep",document.body.appendChild(c)}else alert("Formato de CEP inv\xE1lido.")}else alert("Informe o CEP.")}function optionTypeResidenceEdit(){var a=document.getElementById("optionHomeEdit").checked,b=document.getElementById("optionCondominiumEdit").checked;$("#modalEditPeople #edificeEdit").val(""),$("#modalEditPeople #blockEdit").val(""),$("#modalEditPeople #apartmentEdit").val(""),$("#modalEditPeople #streetCondominiumEdit").val(""),$("#modalEditPeople #numberEdit").val(""),a?($("#modalEditPeople #divEdificeEdit").hide(),$("#modalEditPeople #divBlockEdit").hide(),$("#modalEditPeople #divApartmentEdit").hide(),$("#modalEditPeople #divStreetCondominiumEdit").hide(),$("#modalEditPeople #divNumberEdit").show()):b?($("#modalEditPeople #divEdificeEdit").hide(),$("#modalEditPeople #divBlockEdit").hide(),$("#modalEditPeople #divApartmentEdit").hide(),$("#modalEditPeople #divStreetCondominiumEdit").show(),$("#modalEditPeople #divNumberEdit").show()):($("#modalEditPeople #divEdificeEdit").show(),$("#modalEditPeople #divBlockEdit").show(),$("#modalEditPeople #divApartmentEdit").show(),$("#modalEditPeople #divStreetCondominiumEdit").hide(),$("#modalEditPeople #divNumberEdit").hide())}